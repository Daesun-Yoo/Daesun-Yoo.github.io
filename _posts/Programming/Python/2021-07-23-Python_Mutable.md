---
title : "파이썬 객체 할당 방식 - Mutable 객체와 Immutable 객체의 차이"
classes : wide
excerpt : "파이썬에서 객체의 메모리 할당 방식과 Mutable 객체와 Immutable 객체의 차이를 알아보자"

categories : 
        - Python
toc : true
toc_sticky : true
tags : 
    - "Python Mutable 객체"
    - "Python Immutable 객체"

date : 2021-07-23
last_modified_at: 2021-07-23
---

파이썬의 

## 1. 파이썬의 객체 할당 방식 
파이썬에서 새로운 변수를 선언 후 값을 할당하면 할당되는 값은 컴퓨터의 메모리 공간에 생성되고, 해당 메모리를 참조하는 주소값이 생성된다.  
예를 들어 a = "abc"라는 명령어는 메모리에 "abc"라는 값을 가지는 공간을 생성 후 해당 메모리 주소의 값을 a라는 변수에 연결, 즉 참조 시켜준다.

![image](https://user-images.githubusercontent.com/58183633/126741817-0126d166-07c7-4739-81a0-6c0409b16d62.png)  
(악필에 그림 실력도 똥이라.. ㅠㅠ)


**파이썬에서 b = a의 의미는 변수 a가 참조하는 객체 (메모리 주소)를 변수 b도 참조시킨다는 의미이다** 아래 코드를 통해 그 의미를 확인해보자.

```python
a = "YDS"
b = a
c = b
print(a) # "YDS"
print(b) # "YDS"
print(id(a)) # 3153613340400
print(id(b)) # 3153613340400
# a와 b의 id값이 동일하다
```
변수 a와 b가 참조하는 메모리 주소가 동일함을 확인할 수 있으며 이는 즉 동일한 객체를 참조한다는 의미이다.   
이때 b에 새로운 값을 할당 할 경우, 어떻게 될까? 이는 객체의 가변, 불가변 여부에 따라 다르게 작동한다.

## 2. 가변 객체 (Mutable Obect)와 불가변 객체 (Immutable Object)
 파이썬에서 모든 것은 객체이며, 변수가 어떤 객체를 참조하는지 프로그래머가 선언한다. 그리고 변수가 참조하는 객체의 값이 변경 가능한가의 여부에 따라 가변 객체와 불가변 객체가 나뉘어진다.

## 3. 불가변 객체 - bool / int / float / tuple / str
 말 그대로 값 변경이 불가한 객체이다, 객체의 값을 변경하려고 할 시 다음과 같이 에러가 발생한다.
 ```python
 a = "YDS"
 a[0] = "A"
 # TypeError: 'str' object does not support item assignment
 ```
 변수 a는 불가변 객체로 변수의 값을 변경하고 싶다면 새로운 값을 메모리에 생성하여 변수가 참조하도록 해야한다.
 
 다음 코드를 참조해보자
 ```python
 a = "YDS"
 b = a
print(id(a)) # 2186214878512
print(id(b)) # 2186214878512

b = "ABC" # 변수 b에 새로운 값을 할당, 새로운 객체가 메모리에 생성된다.
print(a) # "YDS"
print(b) # "ABC"
print(id(a)) # 2186214878512
print(id(b)) # 140706017522560
 ```
"ABC"라는 값이 메모리에 없는 경우 해당 값을 가진 객체를 메모리에 생성하며 b는 생성된 객체를 참조한다. 즉 a와 b가 참조하는 메모리의 주소가 달라진 것을 확인할 수 있다.     

동일한 불가변 객체를 참조하는 변수는 아무리 많아도 동일한 메모리를 참조한다. 즉 100만개의 변수의 값을 모두 "YDS"로 선언한다면, 메모리에는 100만개의 변수와 1개의 "YDS" 객체가 존재하며 모든 변수는 "YDS" 객체를 참조한다.

## 4. 가변 객체 - list / dict / set 
값 변경이 가능한 객체이며, 객체의 값을 변경시킬 시 객체를 참조하는 모든 변수의 값이 일괄적으로 바뀐다.
```python
a = [1,2,3]
b = a
print(a) # [1,2,3]
print(b) # [1,2,3]
print(id(a)) # 2186213720576
print(id(b)) # 2186213720576

a[0] = -10 # a가 참조하는 리스트 객체의 값을 변경
print(a) # [-10,2,3]
print(b) # [-10,2,3]
print(id(a)) # 2186213720576
print(id(b)) # 2186213720576
```
위 코드를 통해 a가 참조하는 객체의 값을 변경했는데 b의 값도 함께 바뀌었음을 알 수 있다. 이는 a와 b는 내부적으로 직접 값을 가지고 있는게 아닌, 참조하는 객체의 메모리 주소만을 가지고 있다. 그러므로 객체의 값이 바뀐다면 a,b의 값이 동시에 바뀌는 것은 당연한 것으로 볼 수 있다.  

나 또한 이러한 개념없이 리스트 2개를 동일한 객체를 참조하게 해놓고 각각 다른 용도로 사용하려고 하는 뻘짓을 했던 경험이있다. 동일한 값을 가지는 리스트 2개를 만들어 하나의 리스트만을 변형 후 각각 비교하는 코드를 짜는데 계속 둘 다 동시에 바뀌는 것이다 ㅠㅠ  

**가변 객체는 동일한 값을 가지더라도 생성할때마다 항상 새로운 메모리에 할당된다** 아래 코드를 참조해보자

```python
a = [1,2,3]
b = [1,2,3] # b에 a를 할당 하는게 아니다
print(id(a)) # 2186213720576
print(id(b)) # 140706017522560  

print(a==b) # True 변수가 참조하는 객체의 값이 동일하다

print(id(a)==id(b)) # False 변수가 참조하는 객체가 다르다
print(a is b) # False 변수가 참조하는 객체가 다르다
```
a와 b는 동일한 값을 가지고 있지만 서로 다른 객체를 참조한다. 이럴 경우 내가 a 변수가 참조하는 리스트를 아무리 바꾸어도 b 변수가 참조하는 리스트에는 아무런 영향이 없다. 위 코드에서 알 수 있듯 파이썬에서 ==와 is는 객체의 값을 비교하는 것과 참조하는 객체가 동일한 지를 비교한다는 차이가 있다.